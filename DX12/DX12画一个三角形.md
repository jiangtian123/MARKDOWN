# DX12画一个三角形

## 一 Device



### 1.DXGI创建

DXGI 是一种与Direct3D配合使用的API。它的功能是为了将一些通用的功能抽象出来给所有的DX系列的API使用，如2D渲染和3D渲染都需要创建窗口，需要创建交换链，找到显卡等功能不属于单独的一个图形管线的，就使用DXGI来创建。

```c++
ComPtr<IDXGIFactory5>				pIDXGIFactory5;
UINT nDXGIFactoryFlags = 0U;
CreateDXGIFactory2(nDXGIFactoryFlags, IID_PPV_ARGS(&pIDXGIFactory5);          
```

上诉代码演示了怎么创建一个DXGI。

### 2.寻找显示适配器

显示设备器是当前电脑拥有的显示设备，如显卡。通过DXGI可以枚举所有的显示设备器（一个电脑可以拥有多个显示设备器）。

```c++
//枚举显示设备器.
for (UINT adapterIndex = 1; DXGI_ERROR_NOT_FOUND != pIDXGIFactory5-EnumAdapters1(adapterIndex, &pIAdapter); ++adapterIndex)
		{
			DXGI_ADAPTER_DESC1 desc = {};
			pIAdapter->GetDesc1(&desc);
 
			if (desc.Flags & DXGI_ADAPTER_FLAG_SOFTWARE)
			{//跳过软件虚拟适配器设备
				continue;
			}
			//检查适配器对D3D支持的兼容级别，这里直接要求支持12.1的能力，注意返回接口的那个参数被置为了nullptr，这样
			//就不会实际创建一个设备了，也不用我们啰嗦的再调用release来释放接口。这也是一个重要的技巧，请记住！
			if (SUCCEEDED(D3D12CreateDevice(pIAdapter.Get(), D3D_FEATURE_LEVEL_12_1, _uuidof(ID3D12Device), nullptr)))
			{
				break;
			}
		}
```
 创建DX12设备

一个设备代表了一个显卡，可以这么粗暴理解吧

```c++
ComPtr<ID3D12Device4>				pID3DDevice;
GRS_THROW_IF_FAILED(D3D12CreateDevice(pIAdapter.Get(), D3D_FEATURE_LEVEL_12_1, IID_PPV_ARGS(&pID3DDevice)));
```

## GPU Resource



