# 颜色
## 光和颜色
什么是光
> 光通常指的是人类眼睛可以见的电磁波（可见光），视知觉就是对于可见光的知觉。可见光只是电磁波谱上的某一段频谱，一般是定义为波长介于400至700奈（纳）米（nm）之间的电磁波，也就是波长比紫外线长，比红外线短的电磁波。有些资料来源定义的可见光的波长范围也有不同，较窄的有介于420至680nm，较宽的有介于380至800nm。……光既是一种高频的电磁波，又是一种由称为光子的基本粒子组成的粒子流。因此光同时具有粒子性与波动性，或者说光具有“波粒二象性”。
> 
> ——From wiki

简洁来说，光是一种能量，可以以电磁波的形式传递。将复色光通过棱镜等色散系统分光后，按照光的波长或者频率大小依次排列成图案，就得到了光谱。

光谱中只有一部分的光是可见的，波长大概在400nm到750nm之间，这部分为成为可见光。

那什么是颜色呢？
> 颜色是眼、脑和我们的生活经验对光的颜色类别描述的视觉感知特征，其名称有红色、橙色、黄色、绿色、蓝色或紫色。这种对颜色的感知来自可见光谱中的电磁辐射对人眼视锥细胞的刺激。颜色的种类和颜色的物理规格是通过反射光的波长与物体相联系的。这种反射是由物体的物理性质决定的，如光的吸收、发射光谱等。但人对颜色的感觉不仅仅由光的物理性质所决定，还包含心理等许多因素，比如人类对颜色的感觉往往受到周围颜色的影响。  
—— From wiki

一种表示光的方式为——光谱能量分布图。横坐标为波长，纵坐标为波长的单位能量

<img src=https://agraphicsguy.files.wordpress.com/2018/11/pmc4168854_cia-9-1527fig1.png />

所以姑且可以认为，不同波长的光就是我们看到的颜色

## 人眼怎么看到颜色
简单来说，人眼在视网膜上感知光的细胞有两种

——视杆细胞，用来感知亮度。

——视锥细胞，用来感知颜色。

其中，视锥细胞有三个分类，分别为**S-视锥细胞**，**M-视锥细胞**，**L-视锥细胞**。分别对应着波长的短中长。

一般来说，S-视锥细胞对波长420nm的光线最为敏感，M-视锥细胞530nm的波长最为敏感，而L-视锥细胞对于560nm的波长最为敏感。

下图是三种细胞对不同波长的敏感程度，横坐标为波长，纵坐标为敏感度

<img src=https://pic2.zhimg.com/80/v2-a00c5c7a51a13868cafe4291c064b43e_720w.jpg />

也就是说，光的光谱无论多么复杂，人眼只对光谱中的特定三个波长的敏感，而”颜色“也是这三种波长复合而来。由此可得，即便有两个光谱能量分布完全不一样的复色光，在我们人眼看来它们可能是同样的“颜色”，只要它们对视锥细胞产生的刺激是一致的。

##  量化颜色：Color Matching Functions

用光谱能量分布图表示颜色，需要记录的信息太多，于是受人眼启发，人们选取了三个单波长光，来表示可见光。

这就是**等色匹配实验（color matching experiment**选取三个单波长光，把它们称为primaries（三元光）。对于可见光谱中的每一个单波长光，找出三个参数分别对应每个三元光的强度，使得人眼对它们的颜色感知是一致的。这样对可见光谱中的所有单波长光进行测量，我们就可以得到一组函数r(λ)、g(λ)、b(λ)，把它们画到 一张表上就是：

<img src=https://agraphicsguynotes.com/img/posts/basic_color_science_for_graphcis_engineer/the-color-matching-functions.png />

> 如：450nm的单色光约等于**1.0*B($\lambda$)+0*G($\lambda$)+0*R($\lambda$)**

历史上做了很多这样的等色匹配实验，其中最著名也是应用最广泛（之一）的是1931年的CIE 1931 RGB Color Matching Functions。CIE（International Commission on Illumination，那为啥缩写不是COI而是CIE呢，因为缩写来源于它的法语名2333）是一个1913年成立的组织，致力于制定国际通用的和光与颜色相关的标准。CIE 1931 RGB使用的三元光波长分别是700nm（R）、546.1nm（G）、435.8nm（B）。

> 可以注意到，700nm（R）的波长会取到负值，这是由于，在实验室有些波长不可以通过三元光*正系数得到。
如 待测试的波长为A ， 无论怎么调整RGB的系数都得不到A，这时就会通过让A加上一个波长B即 A+B = x*r(λ)+y*g(λ)+z*b(λ);随后把B移过去，有时就会产生负值。

### 取消负值
由于RGB color space 中有负值，于是有人便转换到了一个XYZ颜色空间，使用一个3x3的空间变换矩阵在两个颜色空间做转换。

XYZ color space有很多好处，最明显的特点就是XYZ color matching functions全是正值，另一个特点是它的Y轴是刻意挑选出来的，它的走向和亮度函数是匹配的，也就是说Y值越大亮度也会越大。

### 再次降维
